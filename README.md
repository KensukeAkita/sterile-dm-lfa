# sterile-dm-lfa: Sterile neutrino dark matter with lepton flavor asymmetries

The code "sterile-dm-lfa" has been developed by Kensuke Akita and Maksym Ovchynnikov to trace the evolution of sterile neutrino dark matter in the presence of primordial lepton flavor asymmetries. The underlying physics and thechnical details are described in the associated preprint [25XX.XXXXX]. If you use this code, please cite this reference.

The code is made of two parts:

1. The Python-based code ("discretization solver") solving the system governing the evolution of the Universe and production of sterile neutrinos in full generality, using the discretization approach. 

2. The Mathematica-based code ("analytic solver") that solves the system governing the evolution of the Universe and production of sterile neutrinos under two assumptions: the narrow width approximation, and negligible back-reaction of sterile neutrinos on the lepton flavor asymmetry. The code is located in the directory `Analytic solver`. 

## The code structure

### Discretization solver

The code contains the following main scripts in Python:

`Solver_SterileDM.ipynb`: is a sample script in the Jupyter Notebook that solves the system of the sterile neutrino production and output the sterile neutrino abundance, its momentum distribution in the current Universe and the evolution of lepton flavor asymmetries mixing with sterile neutrinos.

`Sterile_Nu_Prameters.py`: fixes sterile neutrino mass and mixing angle with active neutrinos, and initial values of lepton flavor asymmetries. In the current version, any flavor space in lepton flavor asymmetries can be taken. On the other hand, sterile neutrinos can mix with only one flavor active neutrinos. 

`System_SterileNuDM.py`: describes the evolution equations for sterile neutrinos, the plasma temperature, and lepton flavor asymmetry mixing with sterile neutrinos.

`Asy_Redistribution.py`: describes the evolution equations for the redistribution of each particle-antiparticle asymmetry.

`Make_Rate_Table.py`: is a script to make a table of the active neutrino interaction rate in temperature (T) and its momentum (y=p/T). This table is an input for System_SterileNuDM.py.

`Setup_Bins`.py: fixes the numbers and ranges of grids, such as the momentum of sterile neutrinos. In particular, the number of grids for the momentum of sterile neutrinos must be very large for numerical convergence. The default is 10001, but the larger value is required for very large lepton asymmetries.  

### Analytic solver

To use it, just open the main notebook <dt><code>analytic-solver.nb</code></dt>, launch all the initialization cells, and then switch to the section *Some applications*. The folder *codes* contains the following sub-codes:

1. <dt><code>thermo-definitions.nb</code></dt>, which contains parameters and definitions for governing thermodynamics of the Universe.

2. <dt><code>asymmetries.m</code></dt> (and its notebook-like version <dt><code>asymmetries.nb</code></dt>), which finds lepton and electric charge potentials given the lepton flavor asymmetries and temperature T.

3. <dt><code>kensukes-datasets.nb</code></dt>, which imports the datasets generated by the Python code, for the purpose of comparison.

4. <dt><code>boltzmann-equation-solver.nb</code></dt> and <dt><code>boltzmann-equation-solver-distribution.nb</code></dt>, which define the Boltzmann equations and their solver for the sterile neutrinos. 

5. <dt><code>narrow-width-validation.nb</code></dt>, which studies the robustness of the narrow width approximation.

6. <dt><code>plots-codes.nb</code></dt>, which contains the codes to plot the output of the solvers.


## Limitations

Details of the limitations of this code are described in the main text of [25XX.XXXXX]. See also Section A in the Supplemental Material for the discretization solver and Section E in the Supplemental Material for the analytic solver.

